<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Blaze Squard | Login / Register</title>
<link rel="icon" href="logo.png" type="png">

<style>
/* GLOBAL RESET */
*{
  margin:0; padding:0; box-sizing:border-box;
  font-family:"Poppins",sans-serif;
}

/* BACKGROUND */
body{
  height:100vh;
  display:flex;
  justify-content:center;
  align-items:center;
  background:linear-gradient(135deg,#1a0000,#330000,#660000);
  animation:bgAnim 10s infinite alternate;
}
@keyframes bgAnim{0%{background-position:0%}100%{background-position:100%}}

/* CARD */
.container{
  width:90%;
  max-width:420px;
  padding:25px;
  border-radius:20px;
  background:rgba(255,255,255,0.1);
  backdrop-filter:blur(10px);
  border:1px solid rgba(255,0,0,0.4);
  box-shadow:0 0 20px rgba(255,0,0,0.4);
  transition:0.4s;
}

/* TITLES */
h2{
  text-align:center;
  color:#ff4444;
  margin-bottom:20px;
  text-shadow:0 0 10px red;
}

/* INPUTS */
.input-group{
  margin-bottom:15px;
  position:relative;
}
input{
  width:100%;
  padding:13px;
  border-radius:10px;
  border:none;
  background:rgba(255,255,255,0.18);
  font-size:15px;
  color:white;
}
input::placeholder{color:#eee}

/* SHOW PASSWORD ICON */
.show-pass{
  position:absolute;
  right:10px; top:50%;
  transform:translateY(-50%);
  cursor:pointer;
  font-size:18px;
  color:white;
}

/* BUTTON */
button{
  width:100%;
  padding:13px;
  background:#ff3333;
  border:none;
  border-radius:10px;
  color:white;
  font-size:17px;
  cursor:pointer;
  transition:0.2s;
  margin-top:5px;
}
button:hover{background:#ff0000}

/* SWITCH TEXT */
.switch{
  text-align:center;
  color:white;
  margin-top:12px;
}
.switch span{
  color:#ff6666;
  cursor:pointer;
  font-weight:bold;
}

/* REGISTER HIDE AT START */
#registerForm{display:none; opacity:0; transition:0.4s;}
#loginForm{display:block; opacity:1; transition:0.4s;}

</style>
</head>
<body>

  <audio id="bgAudio" preload="auto" style="display:none;">
  <source src="audio.mp3" type="audio/mpeg">
</audio>


<div class="container">

  <!-- LOGIN FORM -->
  <div id="loginForm">
    <h2>Blaze Squard Login</h2>

    <div class="input-group">
      <input type="text" id="loginEmail" placeholder="Email or Username">
    </div>

    <div class="input-group">
      <input type="password" id="loginPassword" placeholder="Password">
      <span class="show-pass" onclick="togglePass('loginPassword')">üëÅ</span>
    </div>

    <button onclick="loginUser()">Login</button>

    <p class="switch">Don't have an account?  
      <span onclick="showRegister()">Register</span>
    </p>
  </div>

  <!-- REGISTER FORM -->
  <div id="registerForm">
    <h2>Create Account</h2>

    <div class="input-group">
      <input type="text" id="regUsername" placeholder="Username">
    </div>

    <div class="input-group">
      <input type="email" id="regEmail" placeholder="Email">
    </div>

    <div class="input-group">
      <input type="tel" id="regPhone" placeholder="Phone Number">
    </div>

    <div class="input-group">
      <input type="password" id="regPass" placeholder="Create Password">
      <span class="show-pass" onclick="togglePass('regPass')">üëÅ</span>
    </div>

    <div class="input-group">
      <input type="password" id="regConfirm" placeholder="Confirm Password">
      <span class="show-pass" onclick="togglePass('regConfirm')">üëÅ</span>
    </div>

    <button onclick="registerUser()">Register</button>

    <p class="switch">Already have an account?  
      <span onclick="showLogin()">Login</span>
    </p>
  </div>

</div>

<!-- SUPABASE JS (UMD build) -->
<script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2/dist/umd/supabase.min.js"></script>

<script>
/* SUPABASE CONNECT */
if(!window.supabase){
  console.error('Supabase library not found. Check the CDN script src.');
}
const client = window.supabase.createClient(
  "https://onceaonxjtluncmzpypa.supabase.co",
  "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Im9uY2Vhb254anRsdW5jbXpweXBhIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjQyMjIwNzYsImV4cCI6MjA3OTc5ODA3Nn0.kh4STYzslSu6M4qaM6k4gmKJzKIHDFPKI_jLWiiLv9U"
);

/* PASSWORD TOGGLE */
function togglePass(id){
  var x = document.getElementById(id);
  x.type = x.type === "password" ? "text" : "password";
}

/* SHOW REGISTER */
function showRegister(){
  document.getElementById("loginForm").style.opacity = "0";
  setTimeout(()=>{
    document.getElementById("loginForm").style.display = "none";
    document.getElementById("registerForm").style.display = "block";
    setTimeout(()=> document.getElementById("registerForm").style.opacity = "1", 20);
  },300);
}

/* SHOW LOGIN */
function showLogin(){
  document.getElementById("registerForm").style.opacity = "0";
  setTimeout(()=>{
    document.getElementById("registerForm").style.display = "none";
    document.getElementById("loginForm").style.display = "block";
    setTimeout(()=> document.getElementById("loginForm").style.opacity = "1", 20);
  },300);
}

/* LOGIN FUNCTION */
async function loginUser(){
  const email = document.getElementById("loginEmail").value;
  const pass = document.getElementById("loginPassword").value;

  if(!email || !pass) return alert("Please enter both email and password!");

  const {data, error} = await client.auth.signInWithPassword({
    email: email,
    password: pass
  });

  if(error) {
    console.error("Login error:", error);
    return alert("Login Failed: " + error.message);
  }

  // Delay redirect to ensure session is set
  setTimeout(()=> window.location.href = "home.html", 500);
}

/* REGISTER FUNCTION */
async function registerUser(){
  const email = document.getElementById("regEmail").value;
  const username = document.getElementById("regUsername").value;
  const phone = document.getElementById("regPhone").value;
  const pass = document.getElementById("regPass").value;
  const confirm = document.getElementById("regConfirm").value;

  if(pass !== confirm) return alert("Passwords do not match!");

  const {data, error} = await client.auth.signUp({
    email: email,
    password: pass,
    options: {
      data:{
        username: username,
        phone: phone
      }
    }
  });

  if(error) return alert("Register Failed: " + error.message);

  alert("Account Created!");
  showLogin();
}

  // AUTO PLAY MUSIC ON FIRST USER CLICK
function startAudio() {
  const audio = document.getElementById("bgAudio");
  audio.volume = 0.6;
  audio.loop = true;
  audio.play().catch(() => {});

  window.removeEventListener("click", startAudio);
}

// Start audio when user interacts (browser autoplay policy)
window.addEventListener("click", startAudio);

</script>
</body>
</html>


